<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    

<meta charset="utf-8">



<!-- begin SEO -->









<title>            IOS-XR Ansible      AppHosting @xrdocs!      </title>







<meta property="og:locale" content="en-US">
<meta property="og:site_name" content="AppHosting @xrdocs!">
<meta property="og:title" content="IOS-XR Ansible">


  <link rel="canonical" href="http://localhost:4000/tutorials/IOSXR-Ansible">
  <meta property="og:url" content="http://localhost:4000/tutorials/IOSXR-Ansible">



  <meta property="og:description" content="Getting started with IOSXR and Ansible playbooks">



  <meta name="twitter:site" content="@CiscoDevNet">
  <meta name="twitter:title" content="IOS-XR Ansible">
  <meta name="twitter:description" content="Getting started with IOSXR and Ansible playbooks">
  <meta name="twitter:url" content="http://localhost:4000/tutorials/IOSXR-Ansible">

  
    <meta name="twitter:card" content="summary">
    
      <meta name="twitter:image" content="http://localhost:4000/images/site-logo.png">
    
  

  
    <meta name="twitter:creator" content="@">
  



  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2016-05-15T19:48:00+00:00">
  
    <link rel="next" href="http://localhost:4000/tutorials/xrdocs-formatting-useful-tips" title="@xrdocs Formatting Useful Tips">
  
  
    <link rel="prev" href="http://localhost:4000/tutorials/xrdocs-how-to" title="@xrdocs How-To">
  



  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Organization",
      "url": "http://localhost:4000",
      "logo": "http://localhost:4000/images/site-logo.png"
    }
  </script>



  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "person",
      "name" : "Cisco Systems Inc",
      "url" : "http://localhost:4000",
      "sameAs" : ["https://twitter.com/CiscoDevNet"]
    }
  </script>






<!-- end SEO -->

<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="AppHosting @xrdocs! Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="google-site-verification" content="d7ND0ZOt_6iO7q2p0L2v_TdIbciUEeCFYN8ceT_fmRg">
<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">
<meta http-equiv="cleartype" content="on">
<style>
.underline-on-hover:hover {
    text-decoration: underline;
}
.searchForm{
      border-radius:5px;
      -moz-border-radius:5px;
      -webkit-border-radius:5px;
      width: 900px;
   }
#search_results{
      display: table; margin:0 auto;
   }
</style>


    

<!-- start custom head snippets -->

<link rel="apple-touch-icon-precomposed" sizes="57x57" href="http://localhost:4000/images/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://localhost:4000/images/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:4000/images/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/images/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="60x60" href="http://localhost:4000/images/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="http://localhost:4000/images/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="76x76" href="http://localhost:4000/images/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="http://localhost:4000/images/apple-touch-icon-152x152.png">
<link rel="icon" type="image/png" href="http://localhost:4000/images/favicon-196x196.png" sizes="196x196">
<link rel="icon" type="image/png" href="http://localhost:4000/images/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="http://localhost:4000/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="http://localhost:4000/images/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="http://localhost:4000/images/favicon-128.png" sizes="128x128">
<link rel="shortcut icon" href="http://localhost:4000/images/favicon_cisco.ico">
<meta name="application-name" content=" ">
<meta name="msapplication-TileColor" content="#FFFFFF">
<meta name="msapplication-TileImage" content="http://localhost:4000/images/mstile-144x144.png">
<meta name="msapplication-square70x70logo" content="http://localhost:4000/images/mstile-70x70.png">
<meta name="msapplication-square150x150logo" content="http://localhost:4000/images/mstile-150x150.png">
<meta name="msapplication-wide310x150logo" content="http://localhost:4000/images/mstile-310x150.png">
<meta name="msapplication-square310x310logo" content="http://localhost:4000/images/mstile-310x310.png">


<!-- end custom head snippets -->

  </head>

  <body>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg"><a href="http://localhost:4000/">AppHosting @xrdocs!</a></li>
          
            
            
              <li class="masthead__menu-item"><a href="https://xrdocs.github.io">@xrdocs</a></li>
            
          
            
            
              <li class="masthead__menu-item"><a href="http://localhost:4000/techdocs">Tech-Docs</a></li>
            
          
            
            
              <li class="masthead__menu-item"><a href="http://localhost:4000/blogs">Blogs</a></li>
            
          
            
            
              <li class="masthead__menu-item"><a href="http://localhost:4000/tutorials">Tutorials</a></li>
            
          
            
            
              <li class="masthead__menu-item"><a href="http://localhost:4000/search">Search <i class="fa fa-search" aria-hidden="true"></i></a></li>
            
          
            
            
              <li class="masthead__menu-item"><a href="http://localhost:4000/collection-archive">Archive</a></li>
            
          
            
            
              <li class="masthead__menu-item"><a href="http://localhost:4000/tags">Tags</a></li>
            
          
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    





<div id="main" role="main">
  


  <div class="sidebar sticky">
  



<div itemscope itemtype="http://schema.org/Person">

  <div class="author__avatar">
    
    	<img src="http://localhost:4000/images/Mike_pic.jpg" class="author__avatar" alt="Mike Korshunov">
    
  </div>

  <div class="author__content">
    <h3 class="author__name">Mike Korshunov</h3>
    <p class="author__bio">Good guy</p>
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
      
      
        <li><a href="mailto:mkorshun@cisco.com"><i class="fa fa-fw fa-envelope-square" aria-hidden="true"></i> Email</a></li>
      
      
      
      
      
      
      
      
      
      
      
        <li><a href="http://github.com/maikor"><i class="fa fa-fw fa-github" aria-hidden="true"></i> Github</a></li>
      
      
      
      
      
      
      
      
      
      
      
      
      
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="IOS-XR Ansible">
    <meta itemprop="description" content="Getting started with IOSXR and Ansible playbooks">
    <meta itemprop="datePublished" content="May 15, 2016">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">IOS-XR Ansible
</h1>
          
            <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  2 minutes read
</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        <h1 id="introduction">Introduction</h1>
<p>In this tutorial we are going to cover XRv4 configuration with Ansible. We will setup and try simplest configuration with Unix machine connected to XRv64.</p>

<h2 id="prerequisites">Prerequisites</h2>
<ul>
  <li>Computer with with 4-5GB free RAM;</li>
  <li>Vagrant;</li>
  <li>Ansible;</li>
  <li>
<a href="http://engci-maven-master.cisco.com/artifactory/appdevci-snapshot/">XRv64 image</a>;</li>
</ul>

<h3 id="vagrant-pre-setup">Vagrant pre-setup</h3>

<p>To add XR box, image should be downloaded, after this issue the command:</p>

<div class="highlighter-rouge">
<pre class="highlight"><code>$ vagrant box add xrv64 iosxrv-fullk9-x64.box_2016-05-07-19-04-50
</code></pre>
</div>

<p>Image for Ubuntu will be downloaded from official source:</p>

<div class="highlighter-rouge">
<pre class="highlight"><code>$ vagrant box add ubuntu/trusty64
</code></pre>
</div>

<p>Let’s check for result, we should have box available, box ubuntu/trusty64 and xrv64 should be displayed:</p>

<p><img src="https://cisco.box.com/shared/static/rwa6hxojdjcwu1ln8h0zu5oq6ij30def.png" alt="Box validation">
<img src="https://xrdocs.github.io/xrdocs-images/assets/images/xr_ansible_01_box_list-Copy.png" alt="Box validation"></p>

<p>Vagrantfile with 2 Vagrant boxes should be like:</p>

<div class="highlighter-rouge">
<pre class="highlight"><code>Vagrant.configure(2) do |config|

  config.vm.provision "shell", inline: "echo Hello User"

  config.vm.define "ubuntu" do |ubuntu|
    ubuntu.vm.box = "ubuntu/trusty64"
    ubuntu.vm.network :private_network, virtualbox__intnet: "link1", ip: "10.1.1.10"
  end

  config.vm.define "xr" do |xr|
    xr.vm.box = "xrv64"
    xr.vm.network :private_network, virtualbox__intnet: "link1", ip: "10.1.1.20"
  end

end

</code></pre>
</div>

<p>Next step to create Vagrantfile and boot up boxes:</p>

<p>mkorshun@MKORSHUN-2JPYH MINGW64 ~/Documents/workCisco/tutorial
$ vagrant up</p>

<h3 id="ubuntu-box-pre-configuration">Ubuntu box pre-configuration</h3>

<p>To access Ubuntu box just issue the command (no password required):
<code class="highlighter-rouge">
vagrant ssh
</code></p>

<p>Install Ansible and all required packages for it.</p>

<div class="highlighter-rouge">
<pre class="highlight"><code>sudo apt-get install python-setuptools python-dev build-essential git libssl-dev libffi-dev
sudo easy_install pip sshpass
wget https://bootstrap.pypa.io/ez_setup.py -O - | sudo python

git clone http://gitlab.cisco.com/aermongk/iosxr-ansible.git
git clone git://github.com/ansible/ansible.git --recursive
cd ansible/ &amp;&amp; sudo python setup.py install
</code></pre>
</div>

<p>Create key to access XR in future:</p>

<div class="highlighter-rouge">
<pre class="highlight"><code>vagrant@vagrant-ubuntu-trusty-64:~$ ssh-keygen -t rsa
Generating public/private rsa key pair.
Enter file in which to save the key (/home/vagrant/.ssh/id_rsa):
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
.our identification has been saved in
.pub.public key has been saved in
The key fingerprint is:
4e:a5:24:de:e1:51:7c:85:78:a1:65:b1:08:17:e3:be vagrant@vagrant-ubuntu-trusty-64
The key's randomart image is:
+--[ RSA 2048]----+
|        ..=o==.  |
|         =o*+.   |
|      . + =o.    |
|     . = *       |
|      . S .      |
|       o   .     |
|        . E      |
|                 |
|                 |
+-----------------+
vagrant@vagrant-ubuntu-trusty-64:~$ 
vagrant@vagrant-ubuntu-trusty-64:~$ cat ~/.ssh/id_rsa.pub
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCfbpi4N3Lcl5i9Y8gd/g4x05IvnIfoPJkhdmGBW2HMFwqWgJQkJF1BM8SuukWeG8+Su4g0Un5tU4/nvbAcqBDR7wFEmB7z7k8VQrXZUxeB4Lc1jEwdDLbxxGOUitLQO+IXlHFJVpkp9Ps6tT82xopaSOQFXKDq0vYXdeEMD/k3NG++0u5pOsJu+kXLIULy1Ix6qvcFDRKbqfT14fU/K7vBYz8gP8Cl+sql9ySm7aOSb0liCBx46/SueBX6uadnMgecVBc1GyvmEX5PwBppUr3Cpby2yOf69iX4NnNcWTTrPY7o7LWuXPNiAgbSAS3R7jVBPyTltB9zCbGq8We5UuVX vagrant@vagrant-ubuntu-trusty-64
vagrant@vagrant-ubuntu-trusty-64:~$ 
</code></pre>
</div>

<h3 id="xr-box-pre-configuration">XR box pre-configuration</h3>

<p>To access XR Linux Shell:</p>

<div class="highlighter-rouge">
<pre class="highlight"><code>vagrant ssh xr
</code></pre>
</div>

<p>To access XR console it takes one additional step to figure out port (credentials for ssh: vagrant/vagrant):</p>

<div class="highlighter-rouge">
<pre class="highlight"><code>mkorshun@MKORSHUN-2JPYH MINGW64 ~/Documents/workCisco/tutorial
$ vagrant port xr
The forwarded ports for the machine are listed below. Please note that
these values may differ from values configured in the Vagrantfile if the
provider supports automatic port collision detection and resolution.
 22 (guest) = 2223 (host)
 57722 (guest) = 2200 (host)
mkorshun@MKORSHUN-2JPYH MINGW64 ~/Documents/workCisco/tutorial
$ ssh -p 2223 vagrant@localhost
vagrant@localhost's password:
RP/0/RP0/CPU0:ios#
</code></pre>
</div>

<p>Now let’s  configure IP address at XR box. Issue the commant at XR CLI.</p>

<div class="highlighter-rouge">
<pre class="highlight"><code>conf t
interface GigabitEthernet0/0/0/0
 ipv4 address 10.1.1.20 255.255.255.0
 no shutdown
!
commit
end
</code></pre>
</div>

<p>Finally, let’s check connectivity between boxes:</p>

<div class="highlighter-rouge">
<pre class="highlight"><code>RP/0/RP0/CPU0:ios#ping 10.1.1.20
Mon May  9 08:36:33.071 UTC
Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to 10.1.1.20, timeout is 2 seconds:
!!!!!
Success rate is 100 percent (5/5), round-trip min/avg/max = 1/5/20 ms
RP/0/RP0/CPU0:ios#
</code></pre>
</div>

<p>Let’s copy public part of key from Ubuntu box and allow access without password. For IOS-XR image 6.1.x commands below:</p>

<div class="highlighter-rouge">
<pre class="highlight"><code>vagrant port

scp -P &lt;port used for XR(guest) port 57722&gt; /path/to/host/public_key/id_rsa.pub vagrant@localhost:/home/vagrant/

vagrant ssh xr

cat /home/vagrant/id_rsa.pub &gt;&gt; /home/vagrant/.ssh/authorized_keys
</code></pre>
</div>

<h2 id="ansible-part">Ansible Part</h2>

<p>At first we need to set up environment and hosts</p>

        
      </section>

      <footer class="page__meta">
        
        




        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Updated:</strong> <time datetime="2016-05-15T19:48:00+00:00">May 15, 2016</time></p>
        
      </footer>

      

<section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=http://localhost:4000/tutorials/IOSXR-Ansible" class="btn btn--twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/tutorials/IOSXR-Ansible" class="btn btn--facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=http://localhost:4000/tutorials/IOSXR-Ansible" class="btn btn--google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http://localhost:4000/tutorials/IOSXR-Ansible" class="btn btn--linkedin" title="Share on LinkedIn"><i class="fa fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>

      


  <nav class="pagination">
    
      <a href="http://localhost:4000/tutorials/xrdocs-how-to" class="pagination--pager" title="@xrdocs How-To
">Previous</a>
    
    
      <a href="http://localhost:4000/tutorials/xrdocs-formatting-useful-tips" class="pagination--pager" title="@xrdocs Formatting Useful Tips
">Next</a>
    
  </nav>

    </div>

    
      

<div class="page__comments">
  <h4 class="page__comments-title">Leave a Comment</h4>
  
    <section id="disqus_thread"></section>
  
</div>
    
  </article>

  
  
</div>

    <div class="page__footer">
      <footer>
        

<div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
      <li><a href="https://twitter.com/CiscoDevNet"><i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
    
    
    
      <li><a href="http://github.com/xrdocs"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    <li><a href="http://localhost:4000/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">© 2016 Cisco Systems Inc. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>
      </footer>
    </div>

    <script src="http://localhost:4000/assets/js/main.min.js"></script>





  
  <script type="text/javascript">
  	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  	var disqus_shortname = 'xrdocs';

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function() {
  		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  	})();

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function () {
  		var s = document.createElement('script'); s.async = true;
  		s.type = 'text/javascript';
  		s.src = '//' + disqus_shortname + '.disqus.com/count.js';
  		(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  	}());
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>







  </body>
</html>
